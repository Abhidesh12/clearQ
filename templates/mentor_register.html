{% extends "base.html" %}

{% block title %}Complete Mentor Profile - ClearQ{% endblock %}

{% block content %}
<style>
    .mentor-register-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 40px 20px;
    }
    
    .register-header {
        text-align: center;
        margin-bottom: 40px;
    }
    
    .register-progress {
        display: flex;
        justify-content: space-between;
        margin-bottom: 40px;
        position: relative;
    }
    
    .progress-step {
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
        z-index: 2;
        flex: 1;
    }
    
    .step-number {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: #e2e8f0;
        color: #64748b;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        margin-bottom: 10px;
    }
    
    .step-number.active {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
    }
    
    .register-card {
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0,0,0,0.08);
        padding: 40px;
    }
    
    .form-section {
        margin-bottom: 40px;
        padding-bottom: 30px;
        border-bottom: 1px solid #e2e8f0;
    }
    
    .section-title {
        font-size: 1.2rem;
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .section-title i {
        color: #667eea;
    }
    
    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 20px;
    }
    
    .form-group {
        margin-bottom: 20px;
    }
    
    .form-label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: #334155;
        font-size: 14px;
    }
    
    .form-input {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid #e2e8f0;
        border-radius: 10px;
        font-size: 16px;
        transition: all 0.3s ease;
    }
    
    .form-input:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    
    .form-textarea {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid #e2e8f0;
        border-radius: 10px;
        font-size: 16px;
        min-height: 100px;
        resize: vertical;
    }
    
    .skills-input {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid #e2e8f0;
        border-radius: 10px;
        font-size: 16px;
    }
    
    .skills-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 10px;
    }
    
    .skill-tag {
        background: #e0e7ff;
        color: #3730a3;
        padding: 6px 12px;
        border-radius: 15px;
        font-size: 14px;
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    .skill-tag i {
        cursor: pointer;
        font-size: 12px;
    }
    
    .social-urls-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-top: 15px;
    }
    
    .social-input-group {
        position: relative;
    }
    
    .social-icon {
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
        color: #64748b;
        width: 20px;
        text-align: center;
    }
    
    .social-input {
        width: 100%;
        padding: 12px 16px 12px 40px;
        border: 2px solid #e2e8f0;
        border-radius: 10px;
        font-size: 14px;
    }
    
    .social-input:focus {
        outline: none;
        border-color: #667eea;
    }
    
    .submit-btn {
        width: 100%;
        padding: 16px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 12px;
        font-size: 18px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .submit-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 35px rgba(102, 126, 234, 0.3);
    }
</style>

<div class="mentor-register-container">
    <div class="register-header">
        <h1 style="margin-bottom: 10px; color: #1e293b;">Complete Your Mentor Profile</h1>
        <p style="color: #64748b;">Tell learners about your expertise and connect your social profiles</p>
    </div>
    
    <!-- Progress Steps -->
    <div class="register-progress">
        <div class="progress-step">
            <div class="step-number active">1</div>
            <div style="font-size: 14px; color: #64748b;">Basic Info</div>
        </div>
        <div class="progress-step">
            <div class="step-number">2</div>
            <div style="font-size: 14px; color: #64748b;">Expertise</div>
        </div>
        <div class="progress-step">
            <div class="step-number">3</div>
            <div style="font-size: 14px; color: #64748b;">Social Links</div>
        </div>
        <div class="progress-step">
            <div class="step-number">4</div>
            <div style="font-size: 14px; color: #64748b;">Review</div>
        </div>
    </div>
    
    <!-- Registration Form -->
    <div class="register-card">
        <form action="{{ url_for('mentor_register') }}" method="post" enctype="multipart/form-data">
            <!-- Professional Information -->
            <div class="form-section">
                <div class="section-title">
                    <i class="fas fa-briefcase"></i>
                    <span>Professional Information</span>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Current Job Title *</label>
                        <input type="text" name="job_title" class="form-input" 
                               placeholder="e.g., Senior Software Engineer" 
                               value="{{ mentor_profile.job_title if mentor_profile else '' }}" 
                               required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Company *</label>
                        <input type="text" name="company" class="form-input" 
                               placeholder="e.g., Google, Microsoft" 
                               value="{{ mentor_profile.company if mentor_profile else '' }}" 
                               required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Years of Experience *</label>
                        <input type="number" name="experience_years" class="form-input" 
                               placeholder="5" min="1" max="50" 
                               value="{{ mentor_profile.experience_years if mentor_profile else '' }}" 
                               required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Industry *</label>
                        <select name="industry" class="form-input" required>
                            <option value="">Select Industry</option>
                            <option value="Technology" {% if mentor_profile and mentor_profile.industry == 'Technology' %}selected{% endif %}>Technology</option>
                            <option value="Finance" {% if mentor_profile and mentor_profile.industry == 'Finance' %}selected{% endif %}>Finance</option>
                            <option value="Healthcare" {% if mentor_profile and mentor_profile.industry == 'Healthcare' %}selected{% endif %}>Healthcare</option>
                            <option value="Education" {% if mentor_profile and mentor_profile.industry == 'Education' %}selected{% endif %}>Education</option>
                            <option value="Marketing" {% if mentor_profile and mentor_profile.industry == 'Marketing' %}selected{% endif %}>Marketing</option>
                            <option value="Design" {% if mentor_profile and mentor_profile.industry == 'Design' %}selected{% endif %}>Design</option>
                            <option value="Business" {% if mentor_profile and mentor_profile.industry == 'Business' %}selected{% endif %}>Business</option>
                            <option value="Other" {% if mentor_profile and mentor_profile.industry == 'Other' %}selected{% endif %}>Other</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Professional Bio *</label>
                    <textarea name="bio" class="form-textarea" 
                              placeholder="Tell learners about your background, achievements, and what you're passionate about..."
                              required>{{ current_user.bio if current_user.bio else '' }}</textarea>
                </div>
            </div>
            
            <!-- Expertise & Skills -->
            <div class="form-section">
                <div class="section-title">
                    <i class="fas fa-star"></i>
                    <span>Expertise & Skills</span>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Skills *</label>
                    <input type="text" id="skillsInput" class="skills-input" 
                           placeholder="Add skills (e.g., Python, React, Product Management)">
                    <div class="skills-tags" id="skillsTags"></div>
                    <input type="hidden" name="skills" id="skillsHidden" 
                           value="{{ mentor_profile.skills if mentor_profile else '' }}" 
                           required>
                    <div style="font-size: 12px; color: #64748b; margin-top: 5px;">
                        Press Enter to add skills. Add at least 3 skills.
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Hourly Rate (â‚¹) *</label>
                        <input type="number" name="hourly_rate" class="form-input" 
                               placeholder="1000" min="100" step="100" 
                               value="{{ mentor_profile.hourly_rate if mentor_profile else '' }}" 
                               required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Session Duration</label>
                        <select name="session_duration" class="form-input">
                            <option value="30">30 minutes</option>
                            <option value="60" selected>60 minutes</option>
                            <option value="90">90 minutes</option>
                            <option value="120">120 minutes</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Services You Offer *</label>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-top: 10px;">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" name="services" value="mock_interview">
                            <span>Mock Interviews</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" name="services" value="resume_review">
                            <span>Resume Review</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" name="services" value="career_guidance">
                            <span>Career Guidance</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" name="services" value="coding_help">
                            <span>Coding Help</span>
                        </label>
                    </div>
                </div>
            </div>
            
            <!-- Social Links -->
            <div class="form-section">
                <div class="section-title">
                    <i class="fas fa-share-alt"></i>
                    <span>Social Profiles & Links</span>
                </div>
                
                <p style="color: #64748b; margin-bottom: 20px; font-size: 14px;">
                    Add your social profiles to help learners connect with you.
                </p>
                
                <div class="social-urls-grid">
                    <!-- LinkedIn -->
                    <div class="form-group">
                        <label class="form-label">LinkedIn</label>
                        <div class="social-input-group">
                            <div class="social-icon">
                                <i class="fab fa-linkedin"></i>
                            </div>
                            <input type="url" name="linkedin_url" class="social-input" 
                                   placeholder="https://linkedin.com/in/username"
                                   value="{{ mentor_profile.linkedin_url if mentor_profile else '' }}">
                        </div>
                    </div>
                    
                    <!-- Twitter -->
                    <div class="form-group">
                        <label class="form-label">Twitter / X</label>
                        <div class="social-input-group">
                            <div class="social-icon">
                                <i class="fab fa-twitter"></i>
                            </div>
                            <input type="url" name="twitter_url" class="social-input" 
                                   placeholder="https://twitter.com/username"
                                   value="{{ mentor_profile.twitter_url if mentor_profile else '' }}">
                        </div>
                    </div>
                    
                    <!-- GitHub -->
                    <div class="form-group">
                        <label class="form-label">GitHub</label>
                        <div class="social-input-group">
                            <div class="social-icon">
                                <i class="fab fa-github"></i>
                            </div>
                            <input type="url" name="github_url" class="social-input" 
                                   placeholder="https://github.com/username"
                                   value="{{ mentor_profile.github_url if mentor_profile else '' }}">
                        </div>
                    </div>
                    
                    <!-- Portfolio -->
                    <div class="form-group">
                        <label class="form-label">Portfolio</label>
                        <div class="social-input-group">
                            <div class="social-icon">
                                <i class="fas fa-briefcase"></i>
                            </div>
                            <input type="url" name="portfolio_url" class="social-input" 
                                   placeholder="https://yourportfolio.com"
                                   value="{{ mentor_profile.portfolio_url if mentor_profile else '' }}">
                        </div>
                    </div>
                    
                    <!-- YouTube -->
                    <div class="form-group">
                        <label class="form-label">YouTube</label>
                        <div class="social-input-group">
                            <div class="social-icon">
                                <i class="fab fa-youtube"></i>
                            </div>
                            <input type="url" name="youtube_url" class="social-input" 
                                   placeholder="https://youtube.com/c/username"
                                   value="{{ mentor_profile.youtube_url if mentor_profile else '' }}">
                        </div>
                    </div>
                    
                    <!-- Facebook -->
                    <div class="form-group">
                        <label class="form-label">Facebook</label>
                        <div class="social-input-group">
                            <div class="social-icon">
                                <i class="fab fa-facebook"></i>
                            </div>
                            <input type="url" name="facebook_url" class="social-input" 
                                   placeholder="https://facebook.com/username"
                                   value="{{ mentor_profile.facebook_url if mentor_profile else '' }}">
                        </div>
                    </div>
                    
                    <!-- Instagram -->
                    <div class="form-group">
                        <label class="form-label">Instagram</label>
                        <div class="social-input-group">
                            <div class="social-icon">
                                <i class="fab fa-instagram"></i>
                            </div>
                            <input type="url" name="instagram_url" class="social-input" 
                                   placeholder="https://instagram.com/username"
                                   value="{{ mentor_profile.instagram_url if mentor_profile else '' }}">
                        </div>
                    </div>
                    
                    <!-- Website -->
                    <div class="form-group">
                        <label class="form-label">Personal Website</label>
                        <div class="social-input-group">
                            <div class="social-icon">
                                <i class="fas fa-globe"></i>
                            </div>
                            <input type="url" name="website_url" class="social-input" 
                                   placeholder="https://yourwebsite.com"
                                   value="{{ mentor_profile.website_url if mentor_profile else '' }}">
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Profile Photo -->
            <div class="form-section">
                <div class="section-title">
                    <i class="fas fa-camera"></i>
                    <span>Profile Photo</span>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Upload Profile Photo</label>
                    <input type="file" name="profile_image" accept="image/*" class="form-input">
                    <div style="font-size: 12px; color: #64748b; margin-top: 5px;">
                        Recommended size: 400x400px. Max file size: 2MB.
                    </div>
                    {% if current_user.profile_image %}
                    <div style="margin-top: 10px;">
                        <img src="{{ url_for('static', filename=current_user.profile_image) }}" 
                             alt="Current profile" 
                             style="width: 100px; height: 100px; border-radius: 10px; object-fit: cover;">
                        <p style="font-size: 12px; color: #64748b; margin-top: 5px;">Current profile photo</p>
                    </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- Submit -->
            <div style="text-align: center; margin-top: 40px;">
                <button type="submit" class="submit-btn">
                    <i class="fas fa-check-circle"></i> 
                    {% if mentor_profile %}Update Profile{% else %}Complete Registration{% endif %}
                </button>
                <div style="font-size: 14px; color: #64748b; margin-top: 15px;">
                    {% if mentor_profile and mentor_profile.verification_status == 'pending' %}
                    Your profile is under review by our team.
                    {% elif not mentor_profile %}
                    Your profile will be reviewed by our team within 24-48 hours.
                    {% endif %}
                </div>
            </div>
        </form>
    </div>
</div>

<script>
let skills = [];

document.addEventListener('DOMContentLoaded', function() {
    const skillsInput = document.getElementById('skillsInput');
    const skillsTags = document.getElementById('skillsTags');
    const skillsHidden = document.getElementById('skillsHidden');
    
    // Initialize skills from existing data
    const existingSkills = skillsHidden.value;
    if (existingSkills) {
        skills = existingSkills.split(',').map(s => s.trim()).filter(s => s);
        updateSkillsDisplay();
    }
    
    // Add skill on Enter
    skillsInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            e.preventDefault();
            const skill = this.value.trim();
            if (skill && !skills.includes(skill)) {
                skills.push(skill);
                updateSkillsDisplay();
                this.value = '';
            }
        }
    });
    
    // Remove skill
    function removeSkill(skill) {
        skills = skills.filter(s => s !== skill);
        updateSkillsDisplay();
    }
    
    // Update skills display
    function updateSkillsDisplay() {
        skillsTags.innerHTML = '';
        skills.forEach(skill => {
            const tag = document.createElement('div');
            tag.className = 'skill-tag';
            tag.innerHTML = `
                ${skill}
                <i class="fas fa-times" onclick="removeSkill('${skill}')"></i>
            `;
            skillsTags.appendChild(tag);
        });
        skillsHidden.value = skills.join(',');
    }
    
    // Make removeSkill available globally
    window.removeSkill = removeSkill;
});

// Form validation
const form = document.querySelector('form');
form.addEventListener('submit', function(e) {
    // Validate skills
    if (skills.length < 3) {
        e.preventDefault();
        alert('Please add at least 3 skills');
        return;
    }
    
    // Validate services
    const serviceCheckboxes = document.querySelectorAll('input[name="services"]:checked');
    if (serviceCheckboxes.length === 0) {
        e.preventDefault();
        alert('Please select at least one service you offer');
        return;
    }
    
    // Show loading state
    const submitBtn = this.querySelector('.submit-btn');
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
    submitBtn.disabled = true;
});
</script>
{% endblock %}
